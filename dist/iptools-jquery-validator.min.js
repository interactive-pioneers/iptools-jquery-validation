/*! iptools-jquery-validator - v0.1.1 - 2015-09-18
* https://github.com/interactive-pioneers/iptools-jquery-validator
* Copyright © 2015 Interactive Pioneers GmbH; Licensed GPL-3.0 */
!function(a,b,c,d){"use strict";function e(b,c){this.element=b,this.$element=a(b),this.settings=a.extend({},g,c),this._defaults=g,this._name=f,this._errors=[],this._addEventListeners()}var f="iptValidator",g={validateOnSubmit:!0,validateOnCustomEvent:"",stopOnRequired:!1,errorPublishingMode:"appendToParent",errorMsgBoxID:null,errorClass:"error",boxboxAnimationMode:"default",animationDuration:500,wipeTargets:null};e.prototype={_isEmpty:function(a){return 0===a.replace(" ","").length},_isFilled:function(a){var b=a.prop("type");return"checkbox"===b?a.prop("checked"):!this._isEmpty(a.val())},_isValidEmail:function(a){return/^([äöüÜÖÄßA-Za-z0-9_\-\.\+])+\@([äöüÜÖÄßA-Za-z0-9_\-\.])+\.([äöüÜÖÄßA-Za-z]{2,4})$/i.test(a)},_isValidPhone:function(a){return/^(\+)?([\/\d-\s]+)$/.test(a)},_isValidNumeric:function(a){return/^[+-]?\d+(\.\d+)?([eE][+-]?\d+)?$/.test(a)},_isValidNumber:function(a){return/^\d+$/.test(a)},_isValidName:function(a){return/^([^<>|%$\;:,@\"§\{\[\]\}\?\*#]+)$/.test(a)},_isValidStreet:function(a){return/^([\w\däöüÜÖÄß\s\/\&\",\.\'-]+)$/.test(a)},_isValidHouseNumber:function(a){return/^([\w\d-\/\s]+)$/.test(a)},_isValidPostcode:function(a){return/^[A-Za-z0-9][A-Za-z0-9\-\s]{0,10}[A-Za-z0-9]$/i.test(a)},_isUnique:function(b){for(var c,d=this,e=!0,f=b.attr("data-validation-unique-with").split(","),g=b.val(),h=[],i=0,j=f.length;j>i;i++)c="#"+f[i],g+=a(c).val(),h.push(c);var k=b.attr("data-validation-unique-set"),l=this.$element.find("input[type=text][data-validation-unique-set="+k+"]").not(b).not(h.join(" "));return l.each(function(){for(var b=a(this).attr("data-validation-unique-with").split(","),c=d._getElementValue(a(this)),f=0,h=b.length;h>f;f++)c+=a("#"+b[f]).val();c===g&&(e=!1)}),e},_getElementValue:function(b){return"true"===b.attr("data-validation-trim")?a.trim(b.val()):b.val()},_getValidationElements:function(){return this.$element.find("*[data-validation]")},_publishError:function(b,c){var d=a(b);d.addClass(this.settings.errorClass);var e=a("<span></span>").addClass(this.settings.errorClass).text(c);switch(e.hide(),this.settings.errorPublishingMode){case"insertInto":if(null!==this.settings.errorMsgBoxID){var f=a("#"+this.settings.errorMsgBoxID);if(f.length>0&&(e.appendTo(f),f.is(":hidden")))switch(this.settings.boxAnimationMode){case"fade":f.delay(5).css("opacity",0).slideDown(this.settings.animationDuration).animate({opacity:1},this.settings.animationDuration);break;case"slide":f.delay(5).slideDown(this.settings.animationDuration);break;default:f.delay(5).show(this.settings.animationDuration)}}break;case"appendToParent":e.appendTo(d.parent());break;case"prependToParent":e.prependTo(d.parent());break;case"insertBefore":e.insertBefore(d);break;case"insertAfter":e.insertAfter(d)}e.fadeIn(this.settings.animationDuration),e.attr("data-connected-field",d.attr("name"))},_removePublishedErrors:function(b){a(b).removeClass(this.settings.errorClass);var c=a(b).attr("name");if(this.$element.find("span."+this.settings.errorClass+'[data-connected-field="'+c+'"]').remove(),null!==this.settings.errorMsgBoxID){var d=a("#"+this.settings.errorMsgBoxID);d.find("span."+this.settings.errorClass+'[data-connected-field="'+c+'"]').remove()}},_removeAllPublishedErrors:function(){var b=this._getValidationElements();b.removeClass(this.settings.errorClass),this.$element.find("span."+this.settings.errorClass).remove(),null!==this.settings.errorMsgBoxID&&a("#"+this.settings.errorMsgBoxID).hide().empty()},_hideMsgBoxIfEmpty:function(){var b=a("#"+this.settings.errorMsgBoxID);b.is(":empty")&&b.hide()},getErrors:function(){return this._errors},_clearErrors:function(){this._errors=[]},_shallValidate:function(b,c){if(this._isSkippable(b,c))return!1;var d=a(b),e=-1!==d.attr("data-validation").indexOf("required"),f=d.val();return e||f&&f.length>0},_isSkippable:function(b,c){if(a(b).prop("disabled"))return!0;var e="data-validation-skip",f="data-validation-skip-scope",g=this.$element.find("*["+e+"]:selected");if(g.length>0)for(var h,i,j,k=0,l=g.length;l>k;k++)if(j=a(g[k]),i=j.attr(f),typeof i!==d&&0!==a(b).parents("#"+i).length){h=j.attr(e).split(",");for(var m=0,n=h.length;n>m;m++)if(h[m]===c)return!0}return!1},_validateField:function(b){var c=this;c.settings.wipeTargets&&c.wipe();var d=a(b),e=c._getElementValue(d),f=d.data("validation").split(",");c._removePublishedErrors(b);a:for(var g,h=0,i=f.length;i>h;h++){var j=!0;if(g=f[h],-1!==g.indexOf("password-match")&&(g="password-match"),c._shallValidate(b,g)){switch(g){case"required":if(!c._isFilled(d)&&(j=!1,c.settings.stopOnRequired))break a;break;case"email":c._isValidEmail(e)||(j=!1);break;case"phone":c._isValidPhone(e)||(j=!1);break;case"numeric":c._isValidNumeric(e)||(j=!1);break;case"number":c._isValidNumber(e)||(j=!1);break;case"name":c._isValidName(e)||(j=!1);break;case"street":c._isValidStreet(e)||(j=!1);break;case"housenumber":c._isValidHouseNumber(e)||(j=!1);break;case"postcode":c._isValidPostcode(e)||(j=!1);break;case"password-match":var k=f[h].substring(f[h].indexOf("[")+1,f[h].lastIndexOf("]")),l=c.$element.find('input[name="'+k+'"]');(0===l.length||d.val()!==l.val())&&(j=!1);break;case"unique":c._isUnique(d)||(j=!1)}if(!j){var m=d.data("errormsg-"+g);c._publishError(b,m),c._errors.push({field:b,error:m});break a}}}c._hideMsgBoxIfEmpty()},validate:function(){var a=this;a._clearErrors(),a._removeAllPublishedErrors();var b=a._getValidationElements();return b.each(function(){a._validateField(this)}),a._hideMsgBoxIfEmpty(),0===a._errors.length},_handleFormSubmit:function(a){var b=a.data;b.validate()||a.preventDefault()},_addEventListeners:function(){var b=this;this.settings.validateOnSubmit&&this.$element.on("submit."+this._name,null,this,this._handleFormSubmit),""!==this.settings.validateOnCustomEvent&&this.$element.on(this.settings.validateOnCustomEvent,function(){return b.validate()});var c=this._getValidationElements();c.each(function(){var c=a(this);"change"===c.data("validation-trigger")&&c.on("change."+b._name,function(){b._validateField(this)})})},wipe:function(){a(this.settings.wipeTargets).remove()},destroy:function(){this.$element.off("submit."+this._name);var a=this._getValidationElements();a.off("change."+this._name),this.$element.removeData("plugin_"+f)}},a.fn[f]=function(b){return this.each(function(){a.data(this,"plugin_"+f)||a.data(this,"plugin_"+f,new e(this,b))})}}(jQuery,window,document);