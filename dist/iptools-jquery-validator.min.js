/*! iptools-jquery-validator - v2.0.1 - 2017-01-30
* https://github.com/interactive-pioneers/iptools-jquery-validator
* Copyright © 2017 Interactive Pioneers GmbH; Licensed GPL-3.0 */
!function(a,b,c,d){"use strict";function e(b,c){this.element=b,this.$element=a(b),this.settings=a.extend({},h,c),this._defaults=h,this._name=f,this._errors=[],this._addEventListeners()}var f="iptValidator",g={errorMsg:"validation-errormsg",connectedField:"validation-connected-field",errorClassSubscribers:"validation-error-class-subscribers",regExp:"validation-regexp",uniqueWith:"validation-unique-with",uniqueSet:"validation-unique-set",trigger:"validation-trigger",skip:"validation-skip",skipScope:"validation-skip-scope",trim:"validation-trim"},h={animationDuration:500,boxAnimationMode:"default",errorClass:"error",errorMsgBoxID:null,errorPublishingMode:"appendToParent",stopOnRequired:!1,validateOnSubmit:!0,validateOnCustomEvent:null,wipeTargets:null};e.prototype={_getNamespacedEvent:function(a){return a+"."+f},_isEmpty:function(a){return 0===a.replace(" ","").length},_isFilled:function(a){var b=a.prop("type");return"checkbox"===b?a.prop("checked"):!this._isEmpty(a.val())},_matchesRexExp:function(a,b){var c=new RegExp(a.data(g.regExp));return c.test(b)},_isValidEmail:function(a){return/^([^@\s]+)@((?:[-a-z0-9]+\.)+[a-z]{2,})$/i.test(a)},_isValidPhone:function(a){return/^(\+)?([\/\d-\s]+)$/.test(a)},_isValidNumeric:function(a){return/^[+-]?\d+(\.\d+)?([eE][+-]?\d+)?$/.test(a)},_isValidNumber:function(a){return/^\d+$/.test(a)},_isValidName:function(a){return/^([^<>|%$\;:,@\"§\{\[\]\}\?\*#]+)$/.test(a)},_isValidStreet:function(a){return/^([\w\däöüÜÖÄß\s\/\&\",\.\'-]+)$/.test(a)},_isValidHouseNumber:function(a){return/^([\w\d-\/\s]+)$/.test(a)},_isValidPostcode:function(a){return/^[A-Za-z0-9][A-Za-z0-9\-\s]{0,10}[A-Za-z0-9]$/i.test(a)},_isUnique:function(b){var c=this,d=!0,e=b.val(),f=[],h=b.data(g.uniqueWith);if(h){h=h.split(",");for(var i,j=0,k=h.length;j<k;j++)i="#"+h[j],e+=a(i).val(),f.push(i)}var l=b.data(g.uniqueSet),m=this.$element.find("input[type=text][data-"+g.uniqueSet+"="+l+"]").not(b).not(f.join(" "));return m.each(function(){var b=c._getElementValue(a(this)),f=a(this).data(g.uniqueWith);if(f){f=f.split(",");for(var h=0,i=f.length;h<i;h++)b+=a("#"+f[h]).val()}b===e&&(d=!1)}),d},_isMatching:function(a,b){return a.val()===this._getElementFromValidationReference(b).val()},_getElementFromValidationReference:function(a){var b=a.substring(a.indexOf("[")+1,a.lastIndexOf("]"));return this.$element.find('*[name="'+b+'"]')},_getElementValue:function(b){return"true"===b.data(g.trim)?a.trim(b.val()):b.val()},_getValidationElements:function(){return this.$element.find("*[data-validation]")},_publishError:function(b,c){var d=a(b),e=a(a(b).data(g.errorClassSubscribers));d.add(e).addClass(this.settings.errorClass);var f=a("<div/>").addClass(this.settings.errorClass).text(c).attr("data-"+g.connectedField,d.attr("name")).hide();switch(this.settings.errorPublishingMode){case"insertInto":if(null!==this.settings.errorMsgBoxID){var h=a("#"+this.settings.errorMsgBoxID);if(h.length>0&&(f.appendTo(h),h.is(":hidden")))switch(this.settings.boxAnimationMode){case"fade":h.delay(5).css("opacity",0).slideDown(this.settings.animationDuration).animate({opacity:1},this.settings.animationDuration);break;case"slide":h.delay(5).slideDown(this.settings.animationDuration);break;default:h.delay(5).show(this.settings.animationDuration)}}break;case"appendToParent":f.appendTo(d.parent());break;case"prependToParent":f.prependTo(d.parent());break;case"insertBefore":f.insertBefore(d);break;case"insertAfter":f.insertAfter(d)}f.fadeIn(this.settings.animationDuration)},_removePublishedErrors:function(b){var c=a(b),d=a(a(b).data(g.errorClassSubscribers));c.add(d).removeClass(this.settings.errorClass);var e=c.attr("name"),f="*[data-"+g.connectedField+'="'+e+'"]';this.$element.find(f).remove(),null!==this.settings.errorMsgBoxID&&a("#"+this.settings.errorMsgBoxID).find(f).remove()},_removeAllPublishedErrors:function(){var b=this,c=this._getValidationElements();c.removeClass(this.settings.errorClass).each(function(){a(a(this).data(g.errorClassSubscribers)).removeClass(b.settings.errorClass)}),this.$element.find("*[data-"+g.connectedField+"]").remove(),null!==this.settings.errorMsgBoxID&&a("#"+this.settings.errorMsgBoxID).hide().empty()},_hideMsgBoxIfEmpty:function(){var b=a("#"+this.settings.errorMsgBoxID);b.is(":empty")&&b.hide()},getErrors:function(){return this._errors},_clearErrors:function(){this._errors=[]},_shallValidate:function(b,c){if(this._isSkippable(b,c))return!1;var d=a(b),e=d.data("validation").indexOf("required")!==-1,f=d.val();return e||f&&f.length>0},_isSkippable:function(b,c){if(a(b).prop("disabled"))return!0;var e=this.$element.find("*[data-"+g.skip+"]:selected");if(e.length>0)for(var f,h,i,j=0,k=e.length;j<k;j++)if(i=a(e[j]),h=i.data(g.skipScope),typeof h!==d&&0!==a(b).parents("#"+h).length&&(f=i.data(g.skip))){f=f.split(",");for(var l=0,m=f.length;l<m;l++)if(f[l]===c)return!0}return!1},_validateField:function(b){var c=this;c.settings.wipeTargets&&c.wipe();var d=a(b),e=c._getElementValue(d),f=d.data("validation").split(",");c._removePublishedErrors(b);a:for(var h,i=0,j=f.length;i<j;i++){var k=!0;if(h=f[i],h.indexOf("match")!==-1&&(h="match"),c._shallValidate(b,h)){switch(h){case"required":if(!c._isFilled(d)&&(k=!1,c.settings.stopOnRequired))break a;break;case"regexp":c._matchesRexExp(d,e)||(k=!1);break;case"email":c._isValidEmail(e)||(k=!1);break;case"phone":c._isValidPhone(e)||(k=!1);break;case"numeric":c._isValidNumeric(e)||(k=!1);break;case"number":c._isValidNumber(e)||(k=!1);break;case"name":c._isValidName(e)||(k=!1);break;case"street":c._isValidStreet(e)||(k=!1);break;case"housenumber":c._isValidHouseNumber(e)||(k=!1);break;case"postcode":c._isValidPostcode(e)||(k=!1);break;case"match":c._isMatching(d,f[i])?c._removePublishedErrors(c._getElementFromValidationReference(f[i])):k=!1;break;case"unique":c._isUnique(d)||(k=!1)}if(!k){var l=d.data(g.errorMsg+"-"+h);c._publishError(b,l),c._errors.push({field:b,error:l});break a}}}c._hideMsgBoxIfEmpty()},_dispatch:function(a){this.$element.trigger(this._getNamespacedEvent(a))},validate:function(){this._clearErrors(),this._removeAllPublishedErrors();var a=this,b=a._getValidationElements();b.each(function(){a._validateField(this)}),this._hideMsgBoxIfEmpty();var c=0===this._errors.length;return this._dispatch(c?"success":"failure"),c},_handleFormSubmit:function(a){if(!a.data.validate())return!1},_addEventListeners:function(){var b=this;this.settings.validateOnSubmit&&this.$element.on("submit."+this._name,null,this,this._handleFormSubmit),this.settings.validateOnCustomEvent&&this.$element.on(this.settings.validateOnCustomEvent,function(){return b.validate()});var c=this._getValidationElements();c.each(function(){var c=a(this);"change"===c.data(g.trigger)&&c.on("change."+b._name,function(){b._validateField(this)})})},wipe:function(){a(this.settings.wipeTargets).remove()},destroy:function(){this.$element.off("submit."+this._name);var a=this._getValidationElements();a.off("change."+this._name),this.$element.removeData("plugin_"+f)}},a.fn[f]=function(b){return this.each(function(){a.data(this,"plugin_"+f)||a.data(this,"plugin_"+f,new e(this,b))})}}(jQuery,window,document);
